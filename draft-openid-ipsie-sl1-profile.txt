



Network Working Group                                         A. Parecki
Internet-Draft                                                      Okta
Intended status: Informational                              7 March 2025
Expires: 8 September 2025


                    IPSIE SL1 OpenID Connect Profile
                 draft-openid-ipsie-sl1-profile-latest

Abstract

   TODO Abstract

About This Document

   This note is to be removed before publishing as an RFC.

   The latest revision of this draft can be found at
   https://aaronpk.github.io/ipsie-openid-sl1/draft-openid-ipsie-
   sl1-profile.html.  Status information for this document may be found
   at https://datatracker.ietf.org/doc/draft-openid-ipsie-sl1-profile/.

   Source for this draft and an issue tracker can be found at
   https://github.com/aaronpk/ipsie-openid-sl1.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on 8 September 2025.

Copyright Notice

   Copyright (c) 2025 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents (https://trustee.ietf.org/
   license-info) in effect on the date of publication of this document.
   Please review these documents carefully, as they describe your rights
   and restrictions with respect to this document.

Table of Contents

   1.  Introduction
   2.  Conventions and Definitions
   3.  Profile
     3.1.  Network Layer Requirements
       3.1.1.  Requirements for all endpoints
       3.1.2.  Requirements for endpoints not used by web browsers
       3.1.3.  Requirements for endpoints used by web browsers
     3.2.  Cryptography and Secrets
     3.3.  OpenID Connect
       3.3.1.  Requirements for OpenID Providers
       3.3.2.  Requirements for OpenID Relying Parties
   4.  Security Considerations
   5.  IANA Considerations
   6.  Normative References
   Acknowledgments
   Author's Address

1.  Introduction

   TODO Introduction

2.  Conventions and Definitions

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in
   BCP 14 [RFC2119] [RFC8174] when, and only when, they appear in all
   capitals, as shown here.

3.  Profile

3.1.  Network Layer Requirements

3.1.1.  Requirements for all endpoints

   To protect against network attacks, clients, authorization servers,
   and resource servers

   *  shall only offer TLS protected endpoints and shall establish
      connections to other servers using TLS;

   *  shall set up TLS connections using TLS version 1.2 or later;

   *  shall follow the recommendations for Secure Use of Transport Layer
      Security in [BCP195];

   *  should use DNSSEC to protect against DNS spoofing attacks that can
      lead to the issuance of rogue domain-validated TLS certificates;
      and

   *  shall perform a TLS server certificate check, as per [RFC9525].

3.1.2.  Requirements for endpoints not used by web browsers

   For server-to-server communication endpoints that are not used by web
   browsers, the following requirements apply:

   *  When using TLS 1.2, servers shall only permit the cipher suites
      recommended in [BCP195];

   *  When using TLS 1.2, clients should only permit the cipher suites
      recommended in [BCP195].

3.1.3.  Requirements for endpoints used by web browsers

   For endpoints that are used by web browsers, the following additional
   requirements apply:

   *  Servers shall use methods to ensure that connections cannot be
      downgraded using TLS stripping attacks.  A preloaded [preload]
      HTTP Strict Transport Security policy [RFC6797] can be used for
      this purpose.  Some top-level domains, like .bank and .insurance,
      have set such a policy and therefore protect all second-level
      domains below them.

   *  When using TLS 1.2, servers shall only use cipher suites allowed
      in [BCP195].

   *  Servers shall not support [CORS] for the authorization endpoint,
      as clients must perform an HTTP redirect rather than access this
      endpoint directly.

3.2.  Cryptography and Secrets

3.3.  OpenID Connect

   In the following, a profile of the following technologies is defined:

   *  OpenID Connect Core 1.0 incorporating errata set 2
      [OpenID.Discovery]

   *  OpenID Connect Discovery [OpenID.Discovery]

   *  OAuth 2.0 Authorization Framework [RFC6749]

   *  Proof Key for Code Exchange (PKCE) [RFC7636]

   *  OAuth 2.0 Authorization Server Metadata [RFC8414]

   *  OAuth 2.0 Demonstrating Proof of Possession (DPoP) [RFC9449]

   *  OAuth 2.0 Authorization Server Issuer Identification [RFC9207]

3.3.1.  Requirements for OpenID Providers

3.3.1.1.  General Requirements

   OpenID Providers:

   *  shall distribute discovery metadata (such as the authorization
      endpoint) via the metadata document as specified in
      [OpenID.Discovery];

   *  shall reject requests using the resource owner password
      credentials grant;

   *  shall only support confidential clients as defined in [RFC6749];

   *  shall only issue sender-constrained access tokens using DPoP
      [RFC9449];

   *  shall authenticate clients using private_key_jwt as specified in
      Section 9 of [OpenID];

   *  shall not expose open redirectors [[Section 4.11 of RFC9700]];

   *  shall only accept its issuer identifier value (as defined in
      [RFC8414]) as a string in the aud claim received in client
      authentication assertions;

3.3.1.2.  Authorization Endpoint Flows

   For flows that use the authorization endpoint, OpenID Providers:

   *  shall issue authorization codes with a maximum lifetime of 60
      seconds;

   *  shall support "Authorization Code Binding to DPoP Key" (as
      required by [[Section 10.1 of RFC9449]]);

3.3.2.  Requirements for OpenID Relying Parties

4.  Security Considerations

   TODO Security

5.  IANA Considerations

   This document has no IANA actions.

6.  Normative References

   [BCP195]   Best Current Practice 195,
              <https://www.rfc-editor.org/info/bcp195>.
              At the time of writing, this BCP comprises the following:

              Moriarty, K. and S. Farrell, "Deprecating TLS 1.0 and TLS
              1.1", BCP 195, RFC 8996, DOI 10.17487/RFC8996, March 2021,
              <https://www.rfc-editor.org/info/rfc8996>.

              Sheffer, Y., Saint-Andre, P., and T. Fossati,
              "Recommendations for Secure Use of Transport Layer
              Security (TLS) and Datagram Transport Layer Security
              (DTLS)", BCP 195, RFC 9325, DOI 10.17487/RFC9325, November
              2022, <https://www.rfc-editor.org/info/rfc9325>.

   [OpenID]   Sakimura, N., Bradley, J., Jones, M., de Medeiros, B., and
              C. Mortimore, "OpenID Connect Core 1.0 incorporating
              errata set 2", December 2023,
              <https://openid.net/specs/openid-connect-core-1_0.html>.

   [OpenID.Discovery]
              Sakimura, N., Bradley, J., Jones, M., and E. Jay, "OpenID
              Connect Discovery 1.0 incorporating errata set 2",
              December 2023, <https://openid.net/specs/openid-connect-
              discovery-1_0.html>.

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <https://www.rfc-editor.org/rfc/rfc2119>.

   [RFC6749]  Hardt, D., Ed., "The OAuth 2.0 Authorization Framework",
              RFC 6749, DOI 10.17487/RFC6749, October 2012,
              <https://www.rfc-editor.org/rfc/rfc6749>.

   [RFC6750]  Jones, M. and D. Hardt, "The OAuth 2.0 Authorization
              Framework: Bearer Token Usage", RFC 6750,
              DOI 10.17487/RFC6750, October 2012,
              <https://www.rfc-editor.org/rfc/rfc6750>.

   [RFC6797]  Hodges, J., Jackson, C., and A. Barth, "HTTP Strict
              Transport Security (HSTS)", RFC 6797,
              DOI 10.17487/RFC6797, November 2012,
              <https://www.rfc-editor.org/rfc/rfc6797>.

   [RFC7636]  Sakimura, N., Ed., Bradley, J., and N. Agarwal, "Proof Key
              for Code Exchange by OAuth Public Clients", RFC 7636,
              DOI 10.17487/RFC7636, September 2015,
              <https://www.rfc-editor.org/rfc/rfc7636>.

   [RFC8174]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in RFC
              2119 Key Words", BCP 14, RFC 8174, DOI 10.17487/RFC8174,
              May 2017, <https://www.rfc-editor.org/rfc/rfc8174>.

   [RFC8414]  Jones, M., Sakimura, N., and J. Bradley, "OAuth 2.0
              Authorization Server Metadata", RFC 8414,
              DOI 10.17487/RFC8414, June 2018,
              <https://www.rfc-editor.org/rfc/rfc8414>.

   [RFC9207]  Meyer zu Selhausen, K. and D. Fett, "OAuth 2.0
              Authorization Server Issuer Identification", RFC 9207,
              DOI 10.17487/RFC9207, March 2022,
              <https://www.rfc-editor.org/rfc/rfc9207>.

   [RFC9449]  Fett, D., Campbell, B., Bradley, J., Lodderstedt, T.,
              Jones, M., and D. Waite, "OAuth 2.0 Demonstrating Proof of
              Possession (DPoP)", RFC 9449, DOI 10.17487/RFC9449,
              September 2023, <https://www.rfc-editor.org/rfc/rfc9449>.

   [RFC9525]  Saint-Andre, P. and R. Salz, "Service Identity in TLS",
              RFC 9525, DOI 10.17487/RFC9525, November 2023,
              <https://www.rfc-editor.org/rfc/rfc9525>.

   [RFC9700]  Lodderstedt, T., Bradley, J., Labunets, A., and D. Fett,
              "Best Current Practice for OAuth 2.0 Security", BCP 240,
              RFC 9700, DOI 10.17487/RFC9700, January 2025,
              <https://www.rfc-editor.org/rfc/rfc9700>.

Acknowledgments

   TODO acknowledge.

Author's Address

   Aaron Parecki
   Okta
   Email: aaron@parecki.com
